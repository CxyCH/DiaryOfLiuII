# SLAM研究规划

## 0. 引言
SLAM指的是同时进行定位与建图的技术，其中基于视觉的SLAM问题是我们研究的主要内容。基于视觉的SLAM问题可以分为：单目、双目和深度三种技术分支，这三种分支的主要差别在于如何通过图像前端获得摄像头位姿的变化，而后端的优化以及闭环检测都是相同的。我们目前研究的分支是基于深度图像的视觉SLAM问题，但是通过对图像前端的处理，也可以切换到单目和双目两个分支上。  
双目视觉是目前户外应用较多的技术，通过安装两个摄像头，可以利用几何的方法（“对极几何”）利用两个摄像头的图像以及摄像头的相对位姿来计算图像特征点的深度信息。单目视觉获取深度信息的方法本质上与双目视觉的方法类似，但是由于只有一个摄像头，需要利用时间序列上的图像来计算深度信息。深度视觉由于可以直接同时获得特征点的颜色信息和深度信息，因此在降低开发难度的同时可以提高SLAM算法的效率。
目前流行的深度图像获取设备，例如Kinect或Xition，对光照比较敏感，因此难以用于室外。因此SLAM技术在室外的应用，例如谷歌的地图小车、自动驾驶等均使用的是双目视觉。而对于SLAM在移动平台AR方面的应用，由于移动设备的限制，只能使用单目视觉的方式。  
本文的核心问题是如何开展基于深度图像的视觉SLAM的研究，本文的第1部分介绍了SLAM问题的定义，以及初步研究方法和需要了解的领域知识；第2部分介绍了如何去了解SLAM研究前沿状况的方法；第3部分简要介绍SLAM问题中可以深入研究的研究点；第4部分介绍了对该问题的研究规划；最后一部分是对全文的一个简要总结。  

## 1. 基于深度图像的视觉SLAM的初步研究
这一部分主要介绍SLAM的基本步骤、初步研究方法和所需的领域知识。
### 1.1 SLAM的基本步骤
基于深度图像的视觉SLAM的基本步骤包括：  
利用深度图像提取点云数据；  
提取图像帧的特征点；  
由两个连续的图像帧计算位姿的变换；  
根据关键帧拼接点云地图；  
后端优化；
闭环检测。
#### 1.1.1 获取点云数据
点云（point cloud）也可以成为点集（point set）。深度图像传感器通过对空间中的物体进行采样来获得隶属于物体的点集，利用Kinect可以获得每一个点的颜色分量和深度。每个点包含三个颜色分量和深度信息，可以用四元组（r,g,b,depth）表示。由于Kinect的镜头较为复杂，其光路模型难以计算，因此要把Kinect的镜头进行标定，也就是用一个小孔成像的模型来进行替代。此外，由于Kinect分别利用两个镜头来分别获取彩色图像和深度图像，因此还需要将两个镜头所采集的数据标定到同一个坐标系中。  
经典的摄像机标定方法是张正友标定法。  
#### 1.1.2 利用深度图像提取特征点
由Kinect所采集的点集包含640*480个点，如果用所有的点来进行点集配准，其运算量颇为可观。因此需要从深度图像中提取出特征点，这些特征点应该满足对尺度、旋转和平移的不变性。图像处理中的特征点提取算法就是用来解决此类问题，通过图像特征点的提取，一方面可以得到具有不变性的特征点，另外一方面降低的运算的规模。这一步骤的目标就是得到深度图像中具有明显特征的“角点”。 在后面的步骤中，将利用这些“角点”来进行两帧图像之间的配准并计算其仿射变换。
经典的图像特征点提取算法包括：SIFT、SURF和ORB等算法。  
#### 1.1.3 由两个连续的图像帧计算位姿的变换
SLAM方法中机器人的位姿变化可以使用惯性测量单元或图像的方法来获得，基于图像的SLAM方法使用图像的方法来获得两帧图像之间的位姿变化。位姿变化的计算问题被称为PnP问题（P是Pose的含义），通过对两个相邻帧的特征点集合进行位姿变化的计算，这一过程被称为：点集配准。  
经典的点集配准有：ICP(Iterative Closest Point)和RANSAC（RANdom SAmple Consensus）等算法。  
#### 1.1.4 根据关键帧拼接点云地图
通过对点集的配准可以得到两个连续帧之间位姿的仿射变换。但是如果两个连续帧之间的仿射变换幅度太大，表示变化幅度过大。但是通常两个连续帧之间不会有过大的变化，所以过大的变换表示采集的图像帧可能存在问题，需要被抛弃。如果两个连续帧之间的仿射变换幅度过小，则表示两个图像帧之间的变化幅度不大，没有必要保留。所以需要选取两个帧间放射变化幅度适中的图像帧作为关键帧，同时保存两帧之间的仿射变换。  
通过连续的关键帧，以及之间的仿射变换，就可以把不同位姿处获得的特征点（不同位姿处的特征点包含的是以该位姿为坐标系的点集）变换到初始坐标系，从而将所有关键帧的特征点变换到世界坐标系当中，从而得到世界坐标系中的点云地图。  
#### 1.1.5 后端优化
后端优化主要是为了最大程度的消除运动过程和观测过程中噪声，这也是SLAM问题中最核心的问题。其本质是一个优化问题，每个关键点的位姿和每个特征点（路标）的位置是优化问题的参数，而优化函数是运动方程和观测方程误差的MSE（Mean Squared Error）。  
后端优化流行的算法包括：扩展卡尔曼滤波和图优化算法。  
#### 1.1.6 闭环检测
由于机器人在运动的过程中其位姿会存在一些环路，通过检测当前关键帧是否与其他关键帧形成回路，可以最大程度的消除整个环路上的累计误差。闭环检测的核心问题是如何获得当前关键帧与那些关键帧的位姿相近，一般使用图像匹配的方法。例如可以和之前的每帧图像做匹配来完成，但是这种方法运算量太大，可以采用最近关键帧匹配和随机关键帧匹配的方案。也就是每一次都和

## 2. SLAM研究前沿状况研究

## 3. SLAM问题中的研究点

## 4. 研究规划

## 5. 小结